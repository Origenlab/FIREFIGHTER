---
interface Props {
  currentPage: number;
  totalPages: number;
  basePath: string;
}

const { currentPage, totalPages, basePath } = Astro.props;

// Generate page numbers to show
function getPageNumbers(current: number, total: number): (number | '...')[] {
  if (total <= 7) {
    return Array.from({ length: total }, (_, i) => i + 1);
  }

  const pages: (number | '...')[] = [];

  if (current <= 3) {
    pages.push(1, 2, 3, 4, '...', total);
  } else if (current >= total - 2) {
    pages.push(1, '...', total - 3, total - 2, total - 1, total);
  } else {
    pages.push(1, '...', current - 1, current, current + 1, '...', total);
  }

  return pages;
}

const pageNumbers = getPageNumbers(currentPage, totalPages);

const getPageUrl = (page: number) => {
  if (page === 1) {
    return basePath;
  }
  return `${basePath}/pagina/${page}`;
};
---

{totalPages > 1 && (
  <nav aria-label="Paginación" class="flex items-center justify-center gap-1 mt-8">
    {/* Previous Button */}
    {currentPage > 1 ? (
      <a
        href={getPageUrl(currentPage - 1)}
        class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-all"
        rel="prev"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        <span class="hidden sm:inline">Anterior</span>
      </a>
    ) : (
      <span class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-slate-300 bg-slate-50 border border-slate-100 rounded-lg cursor-not-allowed">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        <span class="hidden sm:inline">Anterior</span>
      </span>
    )}

    {/* Page Numbers */}
    <div class="flex items-center gap-1">
      {pageNumbers.map((page) => (
        page === '...' ? (
          <span class="px-3 py-2 text-sm text-slate-400">...</span>
        ) : page === currentPage ? (
          <span
            class="flex items-center justify-center w-10 h-10 text-sm font-bold text-white bg-fire-600 rounded-lg shadow-sm"
            aria-current="page"
          >
            {page}
          </span>
        ) : (
          <a
            href={getPageUrl(page)}
            class="flex items-center justify-center w-10 h-10 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-fire-50 hover:border-fire-200 hover:text-fire-600 transition-all"
          >
            {page}
          </a>
        )
      ))}
    </div>

    {/* Next Button */}
    {currentPage < totalPages ? (
      <a
        href={getPageUrl(currentPage + 1)}
        class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-all"
        rel="next"
      >
        <span class="hidden sm:inline">Siguiente</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </a>
    ) : (
      <span class="flex items-center gap-1 px-3 py-2 text-sm font-medium text-slate-300 bg-slate-50 border border-slate-100 rounded-lg cursor-not-allowed">
        <span class="hidden sm:inline">Siguiente</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </span>
    )}
  </nav>
)}

{/* Page Info */}
{totalPages > 1 && (
  <p class="text-center text-sm text-slate-500 mt-4">
    Página {currentPage} de {totalPages}
  </p>
)}
