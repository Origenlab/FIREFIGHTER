---
import Badge from '../ui/Badge.astro';

interface Props {
  station: {
    id: string;
    data: {
      name: string;
      serviceType: string;
      status: string;
      state: string;
      stateSlug: string;
      municipality: string;
      city: string;
      address: string;
      phone: string;
      services: string[];
      latitude: number;
      longitude: number;
    };
  };
}

const { station } = Astro.props;
const { data } = station;

const serviceTypeLabels: Record<string, string> = {
  'profesional': 'Profesional',
  'voluntario': 'Voluntario',
  'industrial': 'Industrial',
  'aeroportuario': 'Aeroportuario',
  'proteccion-civil': 'Protección Civil',
};

const serviceLabels: Record<string, string> = {
  'combate-incendios': 'Incendios',
  'atencion-medica': 'Médico',
  'rescate-vehicular': 'Rescate',
  'rescate-acuatico': 'Acuático',
  'materiales-peligrosos': 'Hazmat',
  'rescate-alturas': 'Alturas',
  'proteccion-civil': 'Prot. Civil',
  'capacitacion': 'Capacitación',
  'prevencion': 'Prevención',
};
---

<article class="card p-6 hover:border-fire-400 transition-all group">
  <div class="flex items-start justify-between gap-4 mb-4">
    <div>
      <Badge variant={data.status === 'activa' ? 'success' : 'slate'} size="sm">
        {data.status === 'activa' ? 'Activa' : data.status}
      </Badge>
      <Badge variant="fire" size="sm" class="ml-2">
        {serviceTypeLabels[data.serviceType] || data.serviceType}
      </Badge>
    </div>
    <div class="w-10 h-10 bg-fire-100 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-fire-200 transition-colors">
      <svg class="w-5 h-5 text-fire-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"></path>
      </svg>
    </div>
  </div>

  <h3 class="font-display font-semibold text-lg text-slate-800 mb-1 group-hover:text-fire-600 transition-colors">
    {data.name}
  </h3>

  <p class="text-fire-600 text-sm font-medium mb-3">
    {data.municipality}, {data.city}
  </p>

  <div class="flex items-start gap-2 mb-4 text-slate-500 text-sm">
    <svg class="w-4 h-4 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
    </svg>
    <span>{data.address}</span>
  </div>

  <div class="flex flex-wrap gap-2 mb-4">
    {data.services.slice(0, 4).map((service) => (
      <Badge variant="slate" size="sm">
        {serviceLabels[service] || service}
      </Badge>
    ))}
    {data.services.length > 4 && (
      <Badge variant="slate" size="sm">+{data.services.length - 4}</Badge>
    )}
  </div>

  <div class="flex items-center justify-between pt-4 border-t border-slate-100">
    <a
      href={`tel:${data.phone}`}
      class="flex items-center gap-2 text-slate-600 hover:text-fire-600 transition-colors text-sm"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
      </svg>
      <span class="truncate">{data.phone}</span>
    </a>

    <a
      href={`/directorio/${data.stateSlug}/${station.id.split('/').pop()?.replace('.md', '')}`}
      class="text-fire-600 hover:text-fire-700 font-medium text-sm flex items-center gap-1"
    >
      Ver detalle
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
    </a>
  </div>
</article>
